<!DOCTYPE html>
<html lang="ko">
<head>
  <meta charset="UTF-8">
  <title>ë©”ê°€ìŠ¤í„°ë”” ëŸ¬ì…€ ì±—ë´‡</title>
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <style>
    * { box-sizing: border-box; margin: 0; padding: 0; }
    body {
      font-family: system-ui, -apple-system, BlinkMacSystemFont, "Segoe UI", sans-serif;
      background: #f3f4f6;
      display: flex;
      justify-content: center;
      align-items: flex-start;
      min-height: 100vh;
      padding: 20px;
    }
    .app {
      width: 100%;
      max-width: 420px;
      background: #ffffff;
      border-radius: 16px;
      overflow: hidden;
      box-shadow: 0 12px 28px rgba(15, 23, 42, 0.18);
      display: flex;
      flex-direction: column;
      height: 700px;
    }
    header {
      background: #0072ff;
      color: #ffffff;
      padding: 14px 16px;
      display: flex;
      justify-content: space-between;
      align-items: center;
      font-size: 14px;
    }
    header h1 {
      font-size: 16px;
      font-weight: 700;
    }
    header span {
      font-size: 12px;
      opacity: 0.9;
    }
    .chat-area {
      flex: 1;
      padding: 12px 14px;
      overflow-y: auto;
      background: #f9fafb;
    }
    .msg {
      margin-bottom: 10px;
      display: flex;
      align-items: flex-start;
      gap: 6px;
    }
    .msg-bot .bubble {
      background: #e5e7eb;
      color: #111827;
      border-radius: 14px;
      border-bottom-left-radius: 4px;
    }
    .bubble {
      font-size: 13px;
      padding: 9px 11px;
      line-height: 1.4;
      max-width: 85%;
      white-space: pre-line;
    }
    .link-list {
      margin-top: 6px;
      font-size: 12px;
    }
    .link-list a {
      color: #2563eb;
      text-decoration: none;
    }
    .link-list a:hover {
      text-decoration: underline;
    }
    .btn-area {
      border-top: 1px solid #e5e7eb;
      padding: 10px 10px 14px;
      background: #ffffff;
    }
    .btn-title {
      font-size: 12px;
      color: #6b7280;
      margin-bottom: 6px;
    }
    .btn-list {
      display: flex;
      flex-wrap: wrap;
      gap: 8px;
    }
    .chip-btn {
      border-radius: 999px;
      border: 1px solid #d1d5db;
      padding: 7px 12px;
      font-size: 12px;
      background: #ffffff;
      cursor: pointer;
    }
    .chip-btn.main {
      font-weight: 600;
    }
    .chip-btn:hover {
      background: #f3f4f6;
    }
  </style>
</head>
<body>
<div class="app">
  <header>
    <h1>ë©”ê°€ìŠ¤í„°ë”” ëŸ¬ì…€ ì±—ë´‡</h1>
    <span>ëŒ€ì¹˜í•™ì› ì•ˆë‚´</span>
  </header>

  <div class="chat-area" id="chat"></div>

  <div class="btn-area">
    <div class="btn-title" id="btn-title">ì›í•˜ì‹œëŠ” ë©”ë‰´ë¥¼ ì„ íƒí•´ ì£¼ì„¸ìš”.</div>
    <div class="btn-list" id="btn-list"></div>
  </div>
</div>

<script>
  /* ===============================
     ë©”ë‰´ & URL ì„¤ì •
     =============================== */
  const MENU_DATA = {

    // 1. í•™ì› ì´ìš© ê°€ì´ë“œ
    "í•™ì› ì´ìš© ê°€ì´ë“œ": [
      {
        label: "í•™ì› ê³µì§€ì‚¬í•­",
        desc: "ìµœê·¼ í•™ì› ê³µì§€ ë° ì•ˆë‚´ì‚¬í•­",
        url: "https://russeldc.megastudy.net/russel/info/notice/notice.asp"
      },
      {
        label: "ì„¤ëª…íšŒ ì˜ˆì•½/ì•Œë¦¼",
        desc: "ì„¤ëª…íšŒ ì¼ì • í™•ì¸ ë° ì•Œë¦¼ ì‹ ì²­",
        url: "https://russeldc.megastudy.net/russel/entinfo/entry_pt/enter_pt_list.asp"
      },
      {
        label: "ìì£¼í•˜ëŠ” ì§ˆë¬¸",
        desc: "ë“±ë¡, ìˆ˜ê°•, í™˜ë¶ˆ ë“± FAQ",
        url: "https://russeldc.megastudy.net/russel/info/qna/faq.asp"
      },
      {
        label: "1:1 ì˜¨ë¼ì¸ ìƒë‹´",
        desc: "ì˜¨ë¼ì¸ í•™ìŠµÂ·ì§„í•™ ìƒë‹´ ì‹ ì²­",
        url: "https://russeldc.megastudy.net/russel/info/qna/qna.asp"
      },
      {
        label: "ë‹¨ê³¼ ë§ˆê°ê°•ì¢Œ ëŒ€ê¸° ì‹ ì²­",
        desc: "ë§ˆê°ëœ ë‹¨ê³¼ ê°•ì¢Œ ëŒ€ê¸° ì‹ ì²­",
        url: "https://russeldc.megastudy.net/russel/info/waiting/list.asp?ClsCode=1"
      },
      {
        label: "ëª¨ì˜ê³ ì‚¬ êµ¬ë§¤",
        desc: "ëŸ¬ì…€ ëª¨ì˜ê³ ì‚¬ êµ¬ë§¤",
        url: "https://russeldc.megastudy.net/russel/online_mock/index.asp"
      },
      {
        label: "ë§ˆì´í˜ì´ì§€(ì¬ë“±ë¡/êµì¬/ì¢Œì„/ê¸‰ì‹)",
        desc: "ì¬ë“±ë¡, êµì¬, ì¢Œì„ì˜ˆì•½, ê¸‰ì‹ ì‹ ì²­",
        url: "https://russeldc.megastudy.net/russel/entinfo/online/service.asp"
      }
    ],

    // 2. ëª¨ì§‘ìš”ê°• ë° ë‹¨ê³¼ ì‹œê°„í‘œ
    "ëª¨ì§‘ìš”ê°• ë° ë‹¨ê³¼ ì‹œê°„í‘œ": [
      {
        label: "Nìˆ˜ ìš°ì„ ì„ ë°œë°˜ ëª¨ì§‘ìš”ê°•",
        desc: "2026 Nìˆ˜ ìš°ì„ ì„ ë°œë°˜ ëª¨ì§‘ ì•ˆë‚´",
        url: "https://russeldc.megastudy.net/intro/2026/first/index.asp"
      },
      {
        label: "ì¬í•™ìƒ ìœˆí„°ìŠ¤ì¿¨ ëª¨ì§‘ìš”ê°•",
        desc: "ì¬í•™ìƒ ìœˆí„°ìŠ¤ì¿¨ ëª¨ì§‘ ì•ˆë‚´",
        url: "https://russeldc.megastudy.net/intro/2025/winter/index.asp"
      },
      {
        label: "ê³ 3/Nìˆ˜ ë‹¨ê³¼ ì‹œê°„í‘œ",
        desc: "ê³ 3Â·Nìˆ˜ ë‹¨ê³¼ ê°•ì¢Œ ì‹œê°„í‘œ",
        url: "https://russeldc.megastudy.net/russel/campus_common/russel_danka/russel_danka_new.asp?idx=2198"
      },
      {
        label: "ê³ 2/1 ë‹¨ê³¼ ì‹œê°„í‘œ",
        desc: "ê³ 2Â·ê³ 1 ë‹¨ê³¼ ê°•ì¢Œ ì‹œê°„í‘œ",
        url: "https://russeldc.megastudy.net/russel/campus_common/russel_danka/russel_danka_new.asp?idx=2185"
      },
      {
        label: "ì‹œì¦Œ/íŠ¹ê°• ì‹œê°„í‘œ",
        desc: "ì‹œì¦ŒÂ·íŠ¹ê°•(íŒŒì´ë„ ë“±) ì‹œê°„í‘œ",
        url: "https://russeldc.megastudy.net/russel/campus_common/russel_danka/russel_danka_new.asp?idx=2184"
      },
      {
        label: "ë…¼ìˆ  íŠ¹ê°• ì‹œê°„í‘œ",
        desc: "ë…¼ìˆ  íŠ¹ê°• ì‹œê°„í‘œ",
        url: "https://russeldc.megastudy.net/russel/campus_common/russel_danka/russel_danka_new.asp?idx=2105"
      }
    ],

    // 3. ë°”ë¥¸ê³µë¶€ ììŠµì „ìš©ê´€
    "ë°”ë¥¸ê³µë¶€ ììŠµì „ìš©ê´€": [
      {
        label: "ììŠµì „ìš©ê´€ ì•ˆë‚´",
        desc: "ë°”ë¥¸ê³µë¶€ ììŠµì „ìš©ê´€ ìš´ì˜Â·ì´ìš© ì•ˆë‚´",
        url: "https://russeldc.megastudy.net/russel/info/study_hall/study_hall.asp"
      },
      {
        label: "ì¬í•™ìƒ íŠ¹ë³„ í˜œíƒ",
        desc: "ì¬í•™ìƒ ëŒ€ìƒ íŠ¹ë³„ í˜œíƒ ì•ˆë‚´",
        url: "https://russeldc.megastudy.net/russel/event/2020/megapass/megapass.asp"
      },
      {
        label: "ì£¼ê°„ ì‹ë‹¨í‘œ",
        desc: "ì´ë²ˆ ì£¼ í•™ì› ì‹ë‹¨í‘œ í™•ì¸",
        url: "https://russeldc.megastudy.net/russel/campus_common/campus/weekly_food.asp"
      }
    ],

    // 4. ëª¨ì˜ê³ ì‚¬ ì¼ì •/ì½˜í…ì¸ 
    "ëª¨ì˜ê³ ì‚¬ ì¼ì •/ì½˜í…ì¸ ": [
      {
        label: "2026ë…„ ëª¨ì˜ê³ ì‚¬ ì¼ì •",
        desc: "2026ë…„ ëŸ¬ì…€ ëª¨ì˜ê³ ì‚¬ ì¼ì • ì•ˆë‚´",
        url: "https://russeldc.megastudy.net/russel/entinfo/test_schedule.asp?year=2026"
      },
      {
        label: "OMEGA ëª¨ì˜ê³ ì‚¬",
        desc: "OMEGA ëª¨ì˜ê³ ì‚¬ ì†Œê°œ",
        url: "https://russeldc.megastudy.net/event/omega_intro/index.asp"
      },
      {
        label: "ì „êµ­ ëŒ€ë‹¨ìœ„ ì‹¤ì „ ëª¨ì˜ê³ ì‚¬",
        desc: "ì „êµ­ ëŒ€ë‹¨ìœ„ ì‹¤ì „ ëª¨ì˜ê³ ì‚¬ ì•ˆë‚´",
        url: "https://russeldc.megastudy.net/event/2025/jdsm/index.asp"
      },
      {
        label: "ë©”ëŒ€í”„ ëª¨ì˜ê³ ì‚¬",
        desc: "ë©”ëŒ€í”„ ëª¨ì˜ê³ ì‚¬ ì†Œê°œ",
        url: "https://russeldc.megastudy.net/intro/2022/premium/index.asp"
      },
      {
        label: "ALPHA ëª¨ì˜ê³ ì‚¬",
        desc: "ALPHA ëª¨ì˜ê³ ì‚¬ ì†Œê°œ",
        url: "https://russeldc.megastudy.net/event/2025/alpha/index.asp"
      }
    ],

    // 5. ì¶œê°• ì„ ìƒë‹˜ ì•ˆë‚´
    "ì¶œê°• ì„ ìƒë‹˜ ì•ˆë‚´": [
      {
        label: "êµ­ì–´",
        desc: "êµ­ì–´ ì¶œê°• ì„ ìƒë‹˜ ì†Œê°œ",
        url: "https://russeldc.megastudy.net/russel/teacher/teacher.asp?te_les=CD0023"
      },
      {
        label: "ìˆ˜í•™",
        desc: "ìˆ˜í•™ ì¶œê°• ì„ ìƒë‹˜ ì†Œê°œ",
        url: "https://russeldc.megastudy.net/russel/teacher/teacher.asp?te_les=CD0024"
      },
      {
        label: "ì˜ì–´",
        desc: "ì˜ì–´ ì¶œê°• ì„ ìƒë‹˜ ì†Œê°œ",
        url: "https://russeldc.megastudy.net/russel/teacher/teacher.asp?te_les=CD0025"
      },
      {
        label: "í•œêµ­ì‚¬",
        desc: "í•œêµ­ì‚¬ ì¶œê°• ì„ ìƒë‹˜ ì†Œê°œ",
        url: "https://russeldc.megastudy.net/russel/teacher/teacher.asp?te_les=CD0049"
      },
      {
        label: "ì‚¬íšŒ",
        desc: "ì‚¬íšŒ ì¶œê°• ì„ ìƒë‹˜ ì†Œê°œ",
        url: "https://russeldc.megastudy.net/russel/teacher/teacher.asp?te_les=CD0026"
      },
      {
        label: "ê³¼í•™",
        desc: "ê³¼í•™ ì¶œê°• ì„ ìƒë‹˜ ì†Œê°œ",
        url: "https://russeldc.megastudy.net/russel/teacher/teacher.asp?te_les=CD0027"
      },
      {
        label: "ë…¼ìˆ ",
        desc: "ë…¼ìˆ  ì¶œê°• ì„ ìƒë‹˜ ì†Œê°œ",
        url: "https://russeldc.megastudy.net/russel/teacher/teacher.asp?te_les=CD0028"
      }
    ],

    // 6. í•™ì› ì´ìš© ì•ˆë‚´
    "í•™ì› ì´ìš© ì•ˆë‚´": [
      {
        label: "í•™ì› ì‹œì„¤",
        desc: "ê°•ì˜ì‹¤, ììŠµì‹¤ ë“± ì‹œì„¤ ì•ˆë‚´",
        url: "https://russeldc.megastudy.net/russel/info/campus_facility.asp"
      },
      {
        label: "ì˜¤ì‹œëŠ” ê¸¸",
        desc: "ëŸ¬ì…€ ëŒ€ì¹˜í•™ì› ìœ„ì¹˜ ì•ˆë‚´",
        url: "https://russeldc.megastudy.net/russel/info/location.asp"
      },
      {
        label: "ë¬¸ì ì•Œë¦¼ ì‹ ì²­",
        desc: "í•™ì› ë¬¸ì ì•Œë¦¼ ì‹ ì²­/ê´€ë¦¬",
        url: "https://russeldc.megastudy.net/russel/entinfo/entry_pt/enter_pt_list.asp"
      }
    ],

    // [ìš°ì„ ì¶”ê°€] 7. ë‚˜ì˜ ìˆ˜ê°•ì •ë³´ ë©”ë‰´ ì¶”ê°€
    "ë‚˜ì˜ ìˆ˜ê°•ì •ë³´": [
      {
        label: "ìˆ˜ê°•ì •ë³´",
        desc: "í˜„ì¬ ìˆ˜ê°•ì¤‘/ì§€ë‚œ ìˆ˜ê°•ë‚´ì—­ ì¡°íšŒ",
        url: "https://russeldc.megastudy.net/russel/mypage/lecture_course.asp"
      },
      {
        label: "ëŒ€ê¸°ì •ë³´",
        desc: "ëŒ€ê¸° ê°•ì¢Œ ë° ëŒ€ê¸°ë²ˆí˜¸ ì¡°íšŒ",
        url: "https://russeldc.megastudy.net/russel/mypage/waiting.asp"
      },
      {
        label: "ê²°ì œë‚´ì—­",
        desc: "ê²°ì œë‚´ì—­ ë° ì˜ìˆ˜ì¦ ì¡°íšŒ",
        url: "https://russeldc.megastudy.net/russel/mypage/student/account_list.asp"
      },
      {
        label: "í™˜ë¶ˆì‹ ì²­",
        desc: "ë‹¨ê³¼/êµì¬/ë°”ìê´€ í™˜ë¶ˆì‹ ì²­ ë©”ë‰´",
        url: "https://russeldc.megastudy.net/russel/mypage/mypage.asp"
      }
    ]
  };

  /* ===============================
     ê³µí†µ JS ë¡œì§
     =============================== */

  const chat = document.getElementById("chat");
  const btnList = document.getElementById("btn-list");
  const btnTitle = document.getElementById("btn-title");

  const MAIN_MENUS = Object.keys(MENU_DATA);

  // [ìš°ì„ ì¶”ê°€] Google Apps Script ì›¹í›… URL (êµ¬ê¸€ ì‹œíŠ¸ ì—°ë™ìš©)
  const SHEET_WEBHOOK_URL =
    "https://script.google.com/macros/s/AKfycbyyz-H4DhCk3fRDOJIo55ReRVabSCccHLAmfNbsgBvu8z3IiyUJH10mWDR9Ca371tMM/exec";

  // [ìš°ì„ ì¶”ê°€] í˜„ì¬ ìˆ˜ê°•ì¤‘ ê°•ì¢Œ ëª©ë¡ (ë‹¨ê³¼ í™˜ë¶ˆ ì‹œ ì„ íƒìš© ë”ë¯¸ ë°ì´í„°)
  // ì‹¤ì œ ìš´ì˜ ì‹œ ì—¬ê¸°ì— ê°•ì¢Œëª…ì„ ì§ì ‘ ì¶”ê°€í•´ì„œ ì‚¬ìš©í•  ìˆ˜ ìˆìŒ.
  const currentCoursesData = [
    // ì˜ˆì‹œ:
    // "ê³ 3 êµ­ì–´ ì‹¬í™”ë°˜",
    // "ê³ 3 ìˆ˜í•™ ë‹¨ê³¼(ê¸°í•˜)",
    // "Nìˆ˜ ì˜ì–´ ì‹¤ì „ë°˜"
  ];

  function addBotMessage(text, linksHtml = "") {
    const wrap = document.createElement("div");
    wrap.className = "msg msg-bot";

    const bubble = document.createElement("div");
    bubble.className = "bubble";
    bubble.textContent = text;

    // ê¸°ì¡´ ì˜¤íƒ€ ìˆ˜ì •: í’ì„ ê»Œ â†’ bubble (ì •ìƒ ì‘ë™ìš©)
    // [ìš°ì„ ì¶”ê°€] ë§í’ì„  ìš”ì†Œë¥¼ ì‹¤ì œë¡œ ì±„íŒ… ì˜ì—­ì— ë¶™ì´ê¸°
    wrap.appendChild(bubble);

    if (linksHtml) {
      const box = document.createElement("div");
      box.className = "link-list";
      box.innerHTML = linksHtml;
      bubble.appendChild(document.createElement("br"));
      bubble.appendChild(box);
    }

    chat.appendChild(wrap);
    chat.scrollTop = chat.scrollHeight;
  }

  function renderMainButtons() {
    btnTitle.textContent = "ì›í•˜ì‹œëŠ” ë©”ë‰´ë¥¼ ì„ íƒí•´ ì£¼ì„¸ìš”.";
    btnList.innerHTML = "";
    MAIN_MENUS.forEach(menu => {
      const btn = document.createElement("button");
      btn.className = "chip-btn main";
      btn.textContent = menu;
      btn.onclick = () => openMenu(menu);
      btnList.appendChild(btn);
    });
  }

  function openMenu(menuName) {
    const items = MENU_DATA[menuName];
    if (!items) return;

    addBotMessage(`ã€${menuName}ã€ ê´€ë ¨ ì£¼ìš” ë©”ë‰´ì…ë‹ˆë‹¤.\nì›í•˜ì‹œëŠ” í•­ëª©ì„ ì„ íƒí•´ ì£¼ì„¸ìš”.`);

    btnTitle.textContent = `${menuName} ì„¸ë¶€ ë©”ë‰´`;
    btnList.innerHTML = "";

    items.forEach(item => {
      const btn = document.createElement("button");
      btn.className = "chip-btn";
      btn.textContent = item.label;
      btn.title = item.desc;

      // [ìš°ì„ ì¶”ê°€] ë‚˜ì˜ ìˆ˜ê°•ì •ë³´ ë©”ë‰´ ë‚´ íŠ¹ìˆ˜ ë™ì‘ ë¶„ê¸°
      if (item.label === "ìˆ˜ê°•ì •ë³´") {
        // [ìš°ì„ ì¶”ê°€] ìˆ˜ê°•ì •ë³´: í˜„ì¬/ì§€ë‚œ ìˆ˜ê°•ë‚´ì—­ ì•ˆë‚´ìš©
        btn.onclick = () => handleCourseInfo();
      } else if (item.label === "ëŒ€ê¸°ì •ë³´") {
        // [ìš°ì„ ì¶”ê°€] ëŒ€ê¸°ì •ë³´: í•™ë°˜/ê°•ì¢Œ, ë‹´ì„/ê°•ì‚¬, ëŒ€ê¸°ë²ˆí˜¸ ì•ˆë‚´ìš©
        btn.onclick = () => handleWaitingInfo();
      } else if (item.label === "ê²°ì œë‚´ì—­") {
        // [ìš°ì„ ì¶”ê°€] ê²°ì œë‚´ì—­: í•™ì›/ê²°ì œì¼ì/êµ¬ë§¤ë‚´ì—­/ê¸ˆì•¡/ìˆ˜ë‹¨/ìƒíƒœ ì•ˆë‚´ìš©
        btn.onclick = () => handlePaymentInfo();
      } else if (item.label === "í™˜ë¶ˆì‹ ì²­") {
        // [ìš°ì„ ì¶”ê°€] í™˜ë¶ˆì‹ ì²­: ë‹¨ê³¼/êµì¬/ë°”ìê´€ í•˜ìœ„ ë©”ë‰´ ë Œë”ë§
        btn.onclick = () => renderRefundSubMenu();
      } else {
        // ê¸°ë³¸ ë™ì‘: í˜ì´ì§€ ì´ë™ + ë§í¬ ì•ˆë‚´
        btn.onclick = () => {
          const html = `<a href="${item.url}" target="_blank">${item.label} ë°”ë¡œê°€ê¸°</a>`;
          addBotMessage(`${item.label} í˜ì´ì§€ë¡œ ì´ë™í•©ë‹ˆë‹¤.\n(${item.desc})`, html);
          window.open(item.url, "_blank");
        };
      }

      btnList.appendChild(btn);
    });

    const homeBtn = document.createElement("button");
    homeBtn.className = "chip-btn";
    homeBtn.textContent = "â—€ ì²˜ìŒìœ¼ë¡œ";
    homeBtn.onclick = () => {
      addBotMessage("ì²˜ìŒ ë©”ë‰´ë¡œ ëŒì•„ê°‘ë‹ˆë‹¤.");
      renderMainButtons();
    };
    btnList.appendChild(homeBtn);
  }

  /* ===============================
     [ìš°ì„ ì¶”ê°€] ìˆ˜ê°•ì •ë³´ / ëŒ€ê¸°ì •ë³´ / ê²°ì œë‚´ì—­ ì²˜ë¦¬
     =============================== */

  // [ìš°ì„ ì¶”ê°€] ìˆ˜ê°•ì •ë³´: í˜„ì¬ ìˆ˜ê°•ì¤‘ / ì§€ë‚œ ìˆ˜ê°•ë‚´ì—­ ì•ˆë‚´
  function handleCourseInfo() {
    // ì‹¤ì œ ì—°ë™ ì‹œ, ì•„ë˜ ë°°ì—´ì— ë°ì´í„° ì£¼ì… ê°€ëŠ¥
    const currentCourses = []; // í˜„ì¬ ìˆ˜ê°•ì¤‘ ê°•ì¢Œ
    const pastCourses = [];    // ì§€ë‚œ ìˆ˜ê°•ë‚´ì—­

    if (currentCourses.length === 0) {
      addBotMessage("ğŸ“Œ í˜„ì¬ ìˆ˜ê°•ì¤‘ì¸ ê°•ì¢Œê°€ ì—†ìŠµë‹ˆë‹¤.");
    } else {
      let msg = "ğŸ“Œ í˜„ì¬ ìˆ˜ê°•ì¤‘ì¸ ê°•ì¢Œ ëª©ë¡:\n\n";
      currentCourses.forEach((c, i) => {
        msg += `${i + 1}. ${c}\n`;
      });
      addBotMessage(msg);
    }

    if (pastCourses.length === 0) {
      addBotMessage("ğŸ“š ì§€ë‚œ ìˆ˜ê°•ë‚´ì—­ì´ ì—†ìŠµë‹ˆë‹¤.");
    } else {
      let msg = "ğŸ“š ì§€ë‚œ ìˆ˜ê°•ë‚´ì—­:\n\n";
      pastCourses.forEach((c, i) => {
        msg += `${i + 1}. ${c}\n`;
      });
      addBotMessage(msg);
    }
  }

  // [ìš°ì„ ì¶”ê°€] ëŒ€ê¸°ì •ë³´: í•™ë°˜/ê°•ì¢Œ, ë‹´ì„/ê°•ì‚¬, ëŒ€ê¸°ë²ˆí˜¸ ì•ˆë‚´
  function handleWaitingInfo() {
    const waitingList = [
      // ì˜ˆì‹œ í˜•íƒœ:
      // { lecture: "ê³ 3 êµ­ì–´ ì‹¬í™”ë°˜", teacher: "ê¹€íƒœí›ˆT", waitNo: 3 },
      // { lecture: "Nìˆ˜ ìˆ˜í•™ ë‹¨ê³¼", teacher: "ë°•ìŠ¹í˜„T", waitNo: 1 }
    ];

    if (waitingList.length === 0) {
      addBotMessage("í˜„ì¬ ëŒ€ê¸°ì¤‘ì¸ ê°•ì¢Œê°€ ì—†ìŠµë‹ˆë‹¤.");
      return;
    }

    let msg = "ğŸ“‹ ëŒ€ê¸°ì •ë³´ ëª©ë¡\n\n";
    waitingList.forEach((item, i) => {
      msg += `${i + 1}) í•™ë°˜/ê°•ì¢Œ: ${item.lecture}\n`;
      msg += `   ë‹´ì„/ê°•ì‚¬: ${item.teacher}\n`;
      msg += `   ëŒ€ê¸°ë²ˆí˜¸: ${item.waitNo}ë²ˆ\n\n`;
    });

    addBotMessage(msg);
  }

  // [ìš°ì„ ì¶”ê°€] ê²°ì œë‚´ì—­: í•™ì›/ê²°ì œì¼ì/êµ¬ë§¤ë‚´ì—­/ê¸ˆì•¡/ìˆ˜ë‹¨/ìƒíƒœ ì•ˆë‚´
  function handlePaymentInfo() {
    const paymentList = [
      // ì˜ˆì‹œ í˜•íƒœ:
      // {
      //   campus: "ëŸ¬ì…€ ëŒ€ì¹˜",
      //   date: "2025-01-03",
      //   item: "ê³ 3 ìˆ˜í•™ ë‹¨ê³¼",
      //   amount: "350,000ì›",
      //   method: "ì¹´ë“œê²°ì œ(ì‚¼ì„±)",
      //   status: "ê²°ì œì™„ë£Œ"
      // }
    ];

    if (paymentList.length === 0) {
      addBotMessage("ğŸ’³ ê²°ì œë‚´ì—­ì´ ì—†ìŠµë‹ˆë‹¤.");
      return;
    }

    let msg = "ğŸ’³ ê²°ì œë‚´ì—­\n\n";
    paymentList.forEach((p, i) => {
      msg += `${i + 1}) í•™ì›: ${p.campus}\n`;
      msg += `   ê²°ì œì¼ì: ${p.date}\n`;
      msg += `   êµ¬ë§¤ë‚´ì—­: ${p.item}\n`;
      msg += `   ê²°ì œê¸ˆì•¡: ${p.amount}\n`;
      msg += `   ê²°ì œìˆ˜ë‹¨: ${p.method}\n`;
      msg += `   ìƒíƒœ: ${p.status}\n\n`;
    });

    addBotMessage(msg);
  }

  /* ===============================
     [ìš°ì„ ì¶”ê°€] í™˜ë¶ˆì‹ ì²­ í•˜ìœ„ ë©”ë‰´ (ë‹¨ê³¼/êµì¬/ë°”ìê´€)
     =============================== */

  function renderRefundSubMenu() {
    addBotMessage("ì›í•˜ì‹œëŠ” í™˜ë¶ˆ ìœ í˜•ì„ ì„ íƒí•´ ì£¼ì„¸ìš”.");

    btnTitle.textContent = "í™˜ë¶ˆì‹ ì²­ ì„¸ë¶€ ë©”ë‰´";
    btnList.innerHTML = "";

    const subMenus = [
      { label: "ë‹¨ê³¼í™˜ë¶ˆ ì‹ ì²­" },
      { label: "êµì¬í™˜ë¶ˆ ì‹ ì²­" },
      { label: "ë°”ìê´€í™˜ë¶ˆ ì‹ ì²­" }
    ];

    subMenus.forEach(sub => {
      const b = document.createElement("button");
      b.className = "chip-btn";
      b.textContent = sub.label;

      if (sub.label === "ë‹¨ê³¼í™˜ë¶ˆ ì‹ ì²­") {
        // [ìš°ì„ ì¶”ê°€] ë‹¨ê³¼ í™˜ë¶ˆ ì‹ ì²­: ì‹¤ì œ í™˜ë¶ˆ ì‹ ì²­ ë¡œì§ ì—°ê²°
        b.onclick = () => handleRefundSingle();
      } else {
        // [ìš°ì„ ì¶”ê°€] êµì¬/ë°”ìê´€ í™˜ë¶ˆì€ ì¶”í›„ êµ¬í˜„ ì˜ˆì • (í˜„ì¬ëŠ” ì•ˆë‚´ë§Œ)
        b.onclick = () => addBotMessage(`${sub.label} ê¸°ëŠ¥ì€ ì¶”í›„ ì˜¤í”ˆ ì˜ˆì •ì…ë‹ˆë‹¤.`);
      }

      btnList.appendChild(b);
    });

    const homeBtn = document.createElement("button");
    homeBtn.className = "chip-btn";
    homeBtn.textContent = "â—€ ë‚˜ì˜ ìˆ˜ê°•ì •ë³´ë¡œ";
    homeBtn.onclick = () => openMenu("ë‚˜ì˜ ìˆ˜ê°•ì •ë³´");
    btnList.appendChild(homeBtn);
  }

  /* ===============================
     [ìš°ì„ ì¶”ê°€] í•™ìƒ ì •ë³´ ê´€ë¦¬(localStorage) + êµ¬ê¸€ ì‹œíŠ¸ ì—°ë™ + ë‹¨ê³¼ í™˜ë¶ˆ ì²˜ë¦¬
     =============================== */

  // [ìš°ì„ ì¶”ê°€] í•™ìƒ ì •ë³´(ì´ë¦„/í•™ë²ˆ)ë¥¼ ìµœì´ˆ 1íšŒ ì…ë ¥ë°›ê³  localStorageì— ì €ì¥
  function getStudentInfo() {
    let name = localStorage.getItem("studentName");
    let studentId = localStorage.getItem("studentId");

    if (!name || !studentId) {
      name = prompt("í•™ìƒ ì´ë¦„ì„ ì…ë ¥í•´ ì£¼ì„¸ìš”:");
      studentId = prompt("ì¬ì›ìƒ í•™ë²ˆ(6~7ìë¦¬)ì„ ì…ë ¥í•´ ì£¼ì„¸ìš”:");

      if (!name || !studentId) {
        alert("ì´ë¦„ê³¼ í•™ë²ˆ ì…ë ¥ì´ í•„ìš”í•©ë‹ˆë‹¤.");
        return null;
      }

      localStorage.setItem("studentName", name);
      localStorage.setItem("studentId", studentId);
    }

    return { name, studentId };
  }

  // [ìš°ì„ ì¶”ê°€] êµ¬ê¸€ ì‹œíŠ¸(Google Apps Script Webhook)ë¡œ í™˜ë¶ˆ ì •ë³´ë¥¼ ì „ì†¡
  function sendRefundToSheet(type, name, studentId, courses) {
    fetch(SHEET_WEBHOOK_URL, {
      method: "POST",
      headers: { "Content-Type": "application/json" },
      body: JSON.stringify({
        type: type,          // "single" | "book" | "bazaar"
        name: name,          // í•™ìƒ ì´ë¦„
        studentId: studentId, // ì¬ì›ìƒ í•™ë²ˆ
        courses: courses     // í™˜ë¶ˆ ì‹ ì²­ ê°•ì¢Œ ë°°ì—´
      })
    })
      .then(res => res.text())
      .then(text => {
        console.log("Google Sheet Response:", text);
      })
      .catch(err => {
        console.error("Error:", err);
      });
  }

  // [ìš°ì„ ì¶”ê°€] ë‹¨ê³¼í™˜ë¶ˆ ì‹ ì²­: í˜„ì¬ ìˆ˜ê°•ì¤‘ ê°•ì¢Œì—ì„œ ì¤‘ë³µ ì„ íƒ í›„ ì‹œíŠ¸ì— ìë™ ê¸°ë¡
  function handleRefundSingle() {
    const student = getStudentInfo();
    if (!student) return;

    const courseList = currentCoursesData || [];

    if (courseList.length === 0) {
      addBotMessage("ğŸ“Œ í˜„ì¬ ìˆ˜ê°•ì¤‘ì¸ ê°•ì¢Œê°€ ì—†ìŠµë‹ˆë‹¤.");
      return;
    }

    addBotMessage("í™˜ë¶ˆ ì‹ ì²­í•  ê°•ì¢Œë¥¼ ì„ íƒí•´ ì£¼ì„¸ìš”.\n(ì—¬ëŸ¬ ê³¼ëª© ì„ íƒ ê°€ëŠ¥)");

    btnTitle.textContent = "ë‹¨ê³¼í™˜ë¶ˆ ì‹ ì²­ - ê°•ì¢Œ ì„ íƒ";
    btnList.innerHTML = "";

    courseList.forEach(course => {
      const label = document.createElement("label");
      label.style.display = "flex";
      label.style.alignItems = "center";
      label.style.gap = "6px";
      label.style.fontSize = "12px";

      const checkbox = document.createElement("input");
      checkbox.type = "checkbox";
      checkbox.value = course;

      label.appendChild(checkbox);
      label.appendChild(document.createTextNode(course));
      btnList.appendChild(label);
    });

    const okBtn = document.createElement("button");
    okBtn.className = "chip-btn";
    okBtn.textContent = "ì„ íƒ ì™„ë£Œ";
    okBtn.style.marginTop = "10px";

    okBtn.onclick = () => {
      const selected = [...btnList.querySelectorAll("input[type=checkbox]:checked")].map(x => x.value);

      if (selected.length === 0) {
        addBotMessage("ì„ íƒëœ ê°•ì¢Œê°€ ì—†ìŠµë‹ˆë‹¤.");
        return;
      }

      // [ìš°ì„ ì¶”ê°€] ì´ Nê°œ ê°•ì¢Œ í™˜ë¶ˆ ì™„ë£Œ ì•ˆë‚´
      addBotMessage(`ì´ ${selected.length}ê°œ ê°•ì¢Œ í™˜ë¶ˆ ì‹ ì²­ì´ ì™„ë£Œë˜ì—ˆìŠµë‹ˆë‹¤.`);

      // [ìš°ì„ ì¶”ê°€] ì„ íƒí•œ ê°•ì¢Œ ì •ë³´ë¥¼ êµ¬ê¸€ ì‹œíŠ¸ì— ê¸°ë¡
      sendRefundToSheet("single", student.name, student.studentId, selected);
    };

    btnList.appendChild(okBtn);
  }

  function init() {
    const firstMsg =
      "ì•ˆë…•í•˜ì„¸ìš”. ë©”ê°€ìŠ¤í„°ë”” ëŸ¬ì…€ ëŒ€ì¹˜í•™ì› ì±—ë´‡ì…ë‹ˆë‹¤.\n\n" +
      "í•™ì› ì´ìš©, ëª¨ì§‘ìš”ê°•, ë‹¨ê³¼ ì‹œê°„í‘œ, ììŠµì „ìš©ê´€, ëª¨ì˜ê³ ì‚¬, ì¶œê°• ì„ ìƒë‹˜, ë‚˜ì˜ ìˆ˜ê°•ì •ë³´ê¹Œì§€\n" +
      "ì•„ë˜ ë²„íŠ¼ì„ ëˆŒëŸ¬ì„œ ê¶ê¸ˆí•œ ë‚´ìš©ì„ ì„ íƒí•´ ì£¼ì„¸ìš”.";
    addBotMessage(firstMsg);
    renderMainButtons();
  }

  init();
</script>
</body>
</html>
